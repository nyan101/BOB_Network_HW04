# BOB_Network_HW04
WinDivert를 이용한 domain기반 웹사이트 블랙리스트 구현.

### 사용법
> webfilter.exe <차단 사이트 목록 파일>

입력파일의 조건
 * 파일의 첫 행에는 차단할 도메인의 수 N이 입력되고,
 * 이후 N개 행에 걸쳐 차단 대상 도메인이 입력된다.
 * 각 도메인은 다음 조건을 만족해야 한다.
   * "__http://__www.google.com" 과 같이 불필요한 prefix(http://) 를 포함하지 않고,
   * "www.google.com__/__"과 같이 불필요한 suffix(/)를 포함하지 않는다.

### 동작 알고리즘
기본적으로 아호-코라식 알고리즘을 사용했으며, 도메인 기반 차단이라는 점을 고려해 몇 가지 단순화를 적용할 수 있었다.

이용한 조건은 다음과 같다.

__찾고자 하는 문자열(악성 도메인)이 다른 도메인의 substring으로 등장하는 경우를 고려할 필요가 없다.__
: 아호-코라식 알고리즘은 문자열 __매칭__ 알고리즘이 아닌 문자열 __검색__ 알고리즘이다. 따라서 검색 대상 문자열이 원 입력의 substring으로 들어오는 경우 역시 고려하고 있고, 나아가 output link를 통해 검색 대상들 사이에 substring 관계가 있는 경우도 처리하고 있다. 그러나 악성 도메인 여부를 판정하기 위해서는 substring 문제에 관계없이 문자열 전체가 일치하는지 여부만을 고려하면 되므로 output link를 따로 만들 필요가 없다.

### 개선점
#### 성능 향상
현재 아호-코라식 알고리즘을 적용한 결과 속도는 O(w) (w:도메인 길이)로, 이 이상의 극적인 속도 향상은 어려울 것으로 추정된다.

그러나 메모리 측면에서는 개선의 여지가 존재한다. 현재 구현에서는 아호-코라식 알고리즘에서 만들어진 오토마타를 저장해야 하므로 소요되는 메모리는 적어도

(차단 리스트에 포함된 모든 글자 수)x(도메인에 들어갈 수 있는 문자 수) 가 된다.

그러나 앞서 말했듯이 substring 문제를 고려할 필요가 없이 100% 일치하는지만 판정하면 되므로 시간이 오래 걸리는 문자열 비교 대신 해싱(Hashing)을 이용할 수 있다. 32비트 정수의 경우 범위는 약 42억으로 차단 대상이 수만~수십만 이상이 되면 collision 문제가 발생할 수 있다. 이 점에 유의하면서 해시 크기를 정한다면, 이진트리를 이용해 O(w + logN) (N:차단 대상의 수) 안에 판정이 가능하면서도 소요 메모리를 O(N) 수준으로 유지할 수 있다.


#### 차단 규칙에 융통성 적용
현재의 차단 방식으로는 __입력 도메인이 정확히 차단 리스트에 존재하는 경우__ 만을 차단한다. 그러나 다음  두 도메인을 살펴보자

> gilgil.net
>
> www.gilgil.net

확인 결과 둘은 같은 내용을 보여주지만, 현재의 구현으로는 둘 중 하나만이 차단 리스트에 존재하는 경우 나머지 하나를 차단하지 못한다. 따라서 이를  처리하기 위해 도메인을 뒤에서부터 비교해 suffix가 차단 문자열에 속하게 되는 경우 Block하도록 로직을 수정할 수 있다. 이 경우는 앞서 설명한 Hashing을 통한 성능 향상을 적용할 수 없다는 단점이 있
